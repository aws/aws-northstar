ace.define("ace/ext/hardwrap",["require","exports","module","ace/range","ace/editor","ace/config"],(function(require,exports,module){"use strict";var Range=require("../range").Range;function hardWrap(editor,options){for(var max=options.column||editor.getOption("printMarginColumn"),allowMerge=0!=options.allowMerge,row=Math.min(options.startRow,options.endRow),endRow=Math.max(options.startRow,options.endRow),session=editor.session;row<=endRow;){var line=session.getLine(row);if(line.length>max){if(space=findSpace(line,max,5)){var indentation=/^\s*/.exec(line)[0];session.replace(new Range(row,space.start,row,space.end),"\n"+indentation)}endRow++}else if(allowMerge&&/\S/.test(line)&&row!=endRow){var nextLine=session.getLine(row+1);if(nextLine&&/\S/.test(nextLine)){var space,trimmedLine=line.replace(/\s+$/,""),trimmedNextLine=nextLine.replace(/^\s+/,""),mergedLine=trimmedLine+" "+trimmedNextLine;if((space=findSpace(mergedLine,max,5))&&space.start>trimmedLine.length||mergedLine.length<max){var replaceRange=new Range(row,trimmedLine.length,row+1,nextLine.length-trimmedNextLine.length);session.replace(replaceRange," "),row--,endRow--}else trimmedLine.length<line.length&&session.remove(new Range(row,trimmedLine.length,row,line.length))}}row++}function findSpace(line,max,min){if(!(line.length<max)){var before=line.slice(0,max),after=line.slice(max),spaceAfter=/^(?:(\s+)|(\S+)(\s+))/.exec(after),spaceBefore=/(?:(\s+)|(\s+)(\S+))$/.exec(before),start=0,end=0;return spaceBefore&&!spaceBefore[2]&&(start=max-spaceBefore[1].length,end=max),spaceAfter&&!spaceAfter[2]&&(start||(start=max),end=max+spaceAfter[1].length),start?{start:start,end:end}:spaceBefore&&spaceBefore[2]&&spaceBefore.index>min?{start:spaceBefore.index,end:spaceBefore.index+spaceBefore[2].length}:spaceAfter&&spaceAfter[2]?{start:start=max+spaceAfter[2].length,end:start+spaceAfter[3].length}:void 0}}}function wrapAfterInput(e){if("insertstring"==e.command.name&&/\S/.test(e.args)){var editor=e.editor,cursor=editor.selection.cursor;if(cursor.column<=editor.renderer.$printMarginColumn)return;var lastDelta=editor.session.$undoManager.$lastDelta;hardWrap(editor,{startRow:cursor.row,endRow:cursor.row,allowMerge:!1}),lastDelta!=editor.session.$undoManager.$lastDelta&&editor.session.markUndoGroup()}}var Editor=require("../editor").Editor;require("../config").defineOptions(Editor.prototype,"editor",{hardWrap:{set:function(val){val?this.commands.on("afterExec",wrapAfterInput):this.commands.off("afterExec",wrapAfterInput)},value:!1}}),exports.hardWrap=hardWrap})),ace.require(["ace/ext/hardwrap"],(function(m){"object"==typeof module&&"object"==typeof exports&&module&&(module.exports=m)}));